"use strict";(globalThis.webpackChunkfrontend_book=globalThis.webpackChunkfrontend_book||[]).push([[786],{4558(n,e,i){i.r(e),i.d(e,{assets:()=>l,contentTitle:()=>s,default:()=>u,frontMatter:()=>a,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"modules/ros2-robotics/urdf-integration-examples","title":"URDF Integration Examples","description":"Overview","source":"@site/docs/modules/ros2-robotics/urdf-integration-examples.md","sourceDirName":"modules/ros2-robotics","slug":"/modules/ros2-robotics/urdf-integration-examples","permalink":"/docs/modules/ros2-robotics/urdf-integration-examples","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/modules/ros2-robotics/urdf-integration-examples.md","tags":[],"version":"current","frontMatter":{}}');var o=i(4848),r=i(8453);const a={},s="URDF Integration Examples",l={},c=[{value:"Overview",id:"overview",level:2},{value:"Loading URDF in ROS 2",id:"loading-urdf-in-ros-2",level:2},{value:"Using robot_state_publisher",id:"using-robot_state_publisher",level:3},{value:"URDF with Xacro",id:"urdf-with-xacro",level:3},{value:"Integration with Gazebo",id:"integration-with-gazebo",level:2},{value:"Adding Gazebo-Specific Elements",id:"adding-gazebo-specific-elements",level:3},{value:"Gazebo Launch File",id:"gazebo-launch-file",level:3},{value:"Validation Tools",id:"validation-tools",level:2},{value:"Checking URDF Validity",id:"checking-urdf-validity",level:3},{value:"Creating a URDF Validation Script",id:"creating-a-urdf-validation-script",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"URDF Organization",id:"urdf-organization",level:3},{value:"Performance Considerations",id:"performance-considerations",level:3}];function d(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,r.R)(),...n.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.header,{children:(0,o.jsx)(e.h1,{id:"urdf-integration-examples",children:"URDF Integration Examples"})}),"\n",(0,o.jsx)(e.h2,{id:"overview",children:"Overview"}),"\n",(0,o.jsx)(e.p,{children:"This document provides practical examples of integrating URDF models with ROS 2 and simulators like Gazebo."}),"\n",(0,o.jsx)(e.h2,{id:"loading-urdf-in-ros-2",children:"Loading URDF in ROS 2"}),"\n",(0,o.jsx)(e.h3,{id:"using-robot_state_publisher",children:"Using robot_state_publisher"}),"\n",(0,o.jsxs)(e.p,{children:["The ",(0,o.jsx)(e.code,{children:"robot_state_publisher"})," package publishes the state of the robot to the TF tree based on joint positions."]}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.strong,{children:"Launch file example (launch/robot.launch.py):"})}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-python",children:'from launch import LaunchDescription\nfrom launch.actions import DeclareLaunchArgument\nfrom launch.substitutions import Command, PathJoinSubstitution\nfrom launch_ros.actions import Node\nfrom launch_ros.substitutions import FindPackageShare\n\n\ndef generate_launch_description():\n    # Declare arguments\n    declared_arguments = []\n    declared_arguments.append(\n        DeclareLaunchArgument(\n            "robot_description",\n            default_value="",\n            description="Robot description in URDF or XACRO format",\n        )\n    )\n\n    # Get URDF via xacro\n    robot_description = Command([\n        \'xacro \',\n        PathJoinSubstitution([\n            FindPackageShare(\'my_robot_description\'),\n            \'urdf\',\n            \'robot.urdf.xacro\'\n        ])\n    ])\n\n    # Robot State Publisher node\n    robot_state_publisher = Node(\n        package="robot_state_publisher",\n        executable="robot_state_publisher",\n        output="both",\n        parameters=[\n            {"robot_description": robot_description},\n        ],\n    )\n\n    # Joint State Publisher (for visualization)\n    joint_state_publisher = Node(\n        package="joint_state_publisher",\n        executable="joint_state_publisher",\n        output="both",\n    )\n\n    # Joint State Publisher GUI (optional, for manual joint control)\n    joint_state_publisher_gui = Node(\n        package="joint_state_publisher_gui",\n        executable="joint_state_publisher_gui",\n        output="both",\n    )\n\n    # RViz2 node\n    rviz2 = Node(\n        package="rviz2",\n        executable="rviz2",\n        output="both",\n        arguments=["-d", PathJoinSubstitution([\n            FindPackageShare(\'my_robot_description\'),\n            \'rviz\',\n            \'view_robot.rviz\'\n        ])],\n    )\n\n    return LaunchDescription(\n        declared_arguments +\n        [\n            robot_state_publisher,\n            joint_state_publisher,\n            joint_state_publisher_gui,\n            rviz2,\n        ]\n    )\n'})}),"\n",(0,o.jsx)(e.h3,{id:"urdf-with-xacro",children:"URDF with Xacro"}),"\n",(0,o.jsx)(e.p,{children:"Xacro (XML Macros) allows you to create parameterized URDF files:"}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.strong,{children:"Example URDF with Xacro (urdf/robot.urdf.xacro):"})}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0"?>\n<robot xmlns:xacro="http://www.ros.org/wiki/xacro" name="humanoid_robot">\n\n  \x3c!-- Properties --\x3e\n  <xacro:property name="M_PI" value="3.14159"/>\n  <xacro:property name="base_width" value="0.5"/>\n  <xacro:property name="base_length" value="0.3"/>\n  <xacro:property name="base_height" value="1.0"/>\n\n  \x3c!-- Materials --\x3e\n  <material name="blue">\n    <color rgba="0.0 0.0 0.8 1.0"/>\n  </material>\n\n  <material name="red">\n    <color rgba="0.8 0.0 0.0 1.0"/>\n  </material>\n\n  <material name="white">\n    <color rgba="1.0 1.0 1.0 1.0"/>\n  </material>\n\n  \x3c!-- Base Link --\x3e\n  <link name="base_link">\n    <visual>\n      <origin xyz="0 0 ${base_height/2}" rpy="0 0 0"/>\n      <geometry>\n        <box size="${base_width} ${base_length} ${base_height}"/>\n      </geometry>\n      <material name="white"/>\n    </visual>\n\n    <collision>\n      <origin xyz="0 0 ${base_height/2}" rpy="0 0 0"/>\n      <geometry>\n        <box size="${base_width} ${base_length} ${base_height}"/>\n      </geometry>\n    </collision>\n\n    <inertial>\n      <mass value="10.0"/>\n      <origin xyz="0 0 ${base_height/2}" rpy="0 0 0"/>\n      <inertia ixx="1.0" ixy="0.0" ixz="0.0" iyy="1.0" iyz="0.0" izz="1.0"/>\n    </inertial>\n  </link>\n\n  \x3c!-- Macro for creating an arm --\x3e\n  <xacro:macro name="arm" params="side position_x">\n    <link name="${side}_upper_arm">\n      <visual>\n        <geometry>\n          <cylinder radius="0.05" length="0.3"/>\n        </geometry>\n        <material name="blue"/>\n      </visual>\n\n      <collision>\n        <geometry>\n          <cylinder radius="0.05" length="0.3"/>\n        </geometry>\n      </collision>\n\n      <inertial>\n        <mass value="1.0"/>\n        <origin xyz="0 0 -0.15"/>\n        <inertia ixx="0.05" ixy="0.0" ixz="0.0" iyy="0.05" iyz="0.0" izz="0.01"/>\n      </inertial>\n    </link>\n\n    <joint name="${side}_shoulder_joint" type="revolute">\n      <parent link="base_link"/>\n      <child link="${side}_upper_arm"/>\n      <origin xyz="${position_x} 0 ${base_height*0.6}" rpy="0 0 0"/>\n      <axis xyz="0 1 0"/>\n      <limit lower="${-M_PI/2}" upper="${M_PI/2}" effort="10" velocity="1"/>\n    </joint>\n\n    <link name="${side}_lower_arm">\n      <visual>\n        <geometry>\n          <cylinder radius="0.04" length="0.3"/>\n        </geometry>\n        <material name="blue"/>\n      </visual>\n\n      <collision>\n        <geometry>\n          <cylinder radius="0.04" length="0.3"/>\n        </geometry>\n      </collision>\n\n      <inertial>\n        <mass value="0.8"/>\n        <origin xyz="0 0 -0.15"/>\n        <inertia ixx="0.04" ixy="0.0" ixz="0.0" iyy="0.04" iyz="0.0" izz="0.01"/>\n      </inertial>\n    </link>\n\n    <joint name="${side}_elbow_joint" type="revolute">\n      <parent link="${side}_upper_arm"/>\n      <child link="${side}_lower_arm"/>\n      <origin xyz="0 0 -0.3" rpy="0 0 0"/>\n      <axis xyz="0 1 0"/>\n      <limit lower="${-M_PI/2}" upper="${M_PI/2}" effort="10" velocity="1"/>\n    </joint>\n  </xacro:macro>\n\n  \x3c!-- Use the arm macro --\x3e\n  <xacro:arm side="left" position_x="${base_width/2}"/>\n  <xacro:arm side="right" position_x="${-base_width/2}"/>\n\n  \x3c!-- Head --\x3e\n  <link name="head">\n    <visual>\n      <geometry>\n        <sphere radius="0.15"/>\n      </geometry>\n      <material name="red"/>\n    </visual>\n\n    <collision>\n      <geometry>\n        <sphere radius="0.15"/>\n      </geometry>\n    </collision>\n\n    <inertial>\n      <mass value="2.0"/>\n      <origin xyz="0 0 0"/>\n      <inertia ixx="0.1" ixy="0.0" ixz="0.0" iyy="0.1" iyz="0.0" izz="0.1"/>\n    </inertial>\n  </link>\n\n  <joint name="neck_joint" type="revolute">\n    <parent link="base_link"/>\n    <child link="head"/>\n    <origin xyz="0 0 ${base_height}" rpy="0 0 0"/>\n    <axis xyz="0 1 0"/>\n    <limit lower="${-M_PI/4}" upper="${M_PI/4}" effort="5" velocity="1"/>\n  </joint>\n\n</robot>\n'})}),"\n",(0,o.jsx)(e.h2,{id:"integration-with-gazebo",children:"Integration with Gazebo"}),"\n",(0,o.jsx)(e.h3,{id:"adding-gazebo-specific-elements",children:"Adding Gazebo-Specific Elements"}),"\n",(0,o.jsx)(e.p,{children:"To make your URDF work with Gazebo, add Gazebo-specific tags:"}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.strong,{children:"URDF with Gazebo extensions (urdf/robot.gazebo.xacro):"})}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0"?>\n<robot xmlns:xacro="http://www.ros.org/wiki/xacro" name="humanoid_robot_gazebo">\n\n  \x3c!-- Include the basic robot definition --\x3e\n  <xacro:include filename="$(find my_robot_description)/urdf/robot.urdf.xacro"/>\n\n  \x3c!-- Gazebo Materials --\x3e\n  <gazebo reference="base_link">\n    <material>Gazebo/White</material>\n    <mu1>0.2</mu1>\n    <mu2>0.2</mu2>\n  </gazebo>\n\n  <gazebo reference="head">\n    <material>Gazebo/Red</material>\n  </gazebo>\n\n  <gazebo reference="left_upper_arm">\n    <material>Gazebo/Blue</material>\n  </gazebo>\n\n  <gazebo reference="right_upper_arm">\n    <material>Gazebo/Blue</material>\n  </gazebo>\n\n  <gazebo reference="left_lower_arm">\n    <material>Gazebo/Blue</material>\n  </gazebo>\n\n  <gazebo reference="right_lower_arm">\n    <material>Gazebo/Blue</material>\n  </gazebo>\n\n  \x3c!-- Gazebo Plugins --\x3e\n  \x3c!-- Joint state publisher for Gazebo --\x3e\n  <gazebo>\n    <plugin name="joint_state_publisher" filename="libgazebo_ros_joint_state_publisher.so">\n      <joint_name>neck_joint</joint_name>\n      <joint_name>left_shoulder_joint</joint_name>\n      <joint_name>left_elbow_joint</joint_name>\n      <joint_name>right_shoulder_joint</joint_name>\n      <joint_name>right_elbow_joint</joint_name>\n    </plugin>\n  </gazebo>\n\n  \x3c!-- Diff drive controller for base movement (if applicable) --\x3e\n  <gazebo>\n    <plugin name="diff_drive" filename="libgazebo_ros_diff_drive.so">\n      <ros>\n        <namespace>/robot</namespace>\n        <remapping>cmd_vel:=cmd_vel</remapping>\n        <remapping>odom:=odom</remapping>\n      </ros>\n      <left_joint>left_wheel_joint</left_joint>\n      <right_joint>right_wheel_joint</right_joint>\n      <wheel_separation>0.3</wheel_separation>\n      <wheel_diameter>0.15</wheel_diameter>\n      <max_wheel_torque>20</max_wheel_torque>\n      <max_wheel_acceleration>1.0</max_wheel_acceleration>\n      <publish_odom>true</publish_odom>\n      <publish_odom_tf>true</publish_odom_tf>\n      <publish_wheel_tf>true</publish_wheel_tf>\n      <odometry_frame>odom</odometry_frame>\n      <robot_base_frame>base_link</robot_base_frame>\n    </plugin>\n  </gazebo>\n\n  \x3c!-- Position controllers for arm joints --\x3e\n  <gazebo>\n    <plugin name="position_controller" filename="libgazebo_ros_control.so">\n      <robotNamespace>/robot</robotNamespace>\n    </plugin>\n  </gazebo>\n\n</robot>\n'})}),"\n",(0,o.jsx)(e.h3,{id:"gazebo-launch-file",children:"Gazebo Launch File"}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.strong,{children:"Launch file for simulation (launch/simulate.launch.py):"})}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-python",children:'from launch import LaunchDescription\nfrom launch.actions import DeclareLaunchArgument, IncludeLaunchDescription\nfrom launch.launch_description_sources import PythonLaunchDescriptionSource\nfrom launch.substitutions import Command, LaunchConfiguration, PathJoinSubstitution\nfrom launch_ros.actions import Node\nfrom launch_ros.substitutions import FindPackageShare\n\n\ndef generate_launch_description():\n    # Declare arguments\n    declared_arguments = []\n    declared_arguments.append(\n        DeclareLaunchArgument(\n            "use_sim_time",\n            default_value="true",\n            description="Use simulation time",\n        )\n    )\n\n    use_sim_time = LaunchConfiguration("use_sim_time")\n\n    # Get URDF via xacro\n    robot_description = Command([\n        \'xacro \',\n        PathJoinSubstitution([\n            FindPackageShare(\'my_robot_description\'),\n            \'urdf\',\n            \'robot.gazebo.xacro\'\n        ])\n    ])\n\n    # Robot State Publisher node\n    robot_state_publisher = Node(\n        package="robot_state_publisher",\n        executable="robot_state_publisher",\n        output="both",\n        parameters=[\n            {"robot_description": robot_description,\n             "use_sim_time": use_sim_time},\n        ],\n    )\n\n    # Gazebo server\n    gzserver = IncludeLaunchDescription(\n        PythonLaunchDescriptionSource([\n            PathJoinSubstitution([\n                FindPackageShare("gazebo_ros"),\n                "launch",\n                "gzserver.launch.py"\n            ])\n        ]),\n        launch_arguments={"verbose": "false"}.items(),\n    )\n\n    # Gazebo client\n    gzclient = IncludeLaunchDescription(\n        PythonLaunchDescriptionSource([\n            PathJoinSubstitution([\n                FindPackageShare("gazebo_ros"),\n                "launch",\n                "gzclient.launch.py"\n            ])\n        ]),\n    )\n\n    # Spawn robot in Gazebo\n    spawn_robot = Node(\n        package="gazebo_ros",\n        executable="spawn_entity.py",\n        arguments=[\n            "-entity", "humanoid_robot",\n            "-topic", "robot_description",\n            "-x", "0.0",\n            "-y", "0.0",\n            "-z", "0.5"\n        ],\n        output="screen",\n    )\n\n    return LaunchDescription([\n        *declared_arguments,\n        robot_state_publisher,\n        gzserver,\n        gzclient,\n        spawn_robot,\n    ])\n'})}),"\n",(0,o.jsx)(e.h2,{id:"validation-tools",children:"Validation Tools"}),"\n",(0,o.jsx)(e.h3,{id:"checking-urdf-validity",children:"Checking URDF Validity"}),"\n",(0,o.jsx)(e.p,{children:"Use these command-line tools to validate your URDF:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-bash",children:"# Check if URDF is valid\ncheck_urdf $(ros2 pkg prefix my_robot_description)/share/my_robot_description/urdf/robot.urdf.xacro\n\n# Or using xacro directly\nros2 run xacro xacro $(find-pkg-share my_robot_description)/urdf/robot.urdf.xacro\n\n# View the robot in RViz\nros2 launch my_robot_description robot.launch.py\n"})}),"\n",(0,o.jsx)(e.h3,{id:"creating-a-urdf-validation-script",children:"Creating a URDF Validation Script"}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.strong,{children:"Python script for URDF validation (scripts/validate_urdf.py):"})}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-python",children:'#!/usr/bin/env python3\n\nimport sys\nimport subprocess\nimport xml.etree.ElementTree as ET\nfrom pathlib import Path\n\n\ndef validate_urdf(urdf_file_path):\n    """\n    Validate a URDF file for basic syntax and structure\n    """\n    try:\n        # Parse the URDF file\n        tree = ET.parse(urdf_file_path)\n        root = tree.getroot()\n\n        # Check if it\'s a valid robot file\n        if root.tag != \'robot\':\n            print(f"ERROR: Root element is not \'robot\', got \'{root.tag}\'")\n            return False\n\n        robot_name = root.get(\'name\')\n        if not robot_name:\n            print("ERROR: Robot element missing \'name\' attribute")\n            return False\n\n        print(f"\u2713 Robot name: {robot_name}")\n\n        # Count links and joints\n        links = root.findall(\'link\')\n        joints = root.findall(\'joint\')\n\n        print(f"\u2713 Found {len(links)} links")\n        print(f"\u2713 Found {len(joints)} joints")\n\n        # Check for common issues\n        link_names = [link.get(\'name\') for link in links]\n        joint_names = [joint.get(\'name\') for joint in joints]\n\n        # Check for duplicate names\n        if len(link_names) != len(set(link_names)):\n            print("ERROR: Duplicate link names found")\n            return False\n\n        if len(joint_names) != len(set(joint_names)):\n            print("ERROR: Duplicate joint names found")\n            return False\n\n        # Check joint parent-child relationships\n        for joint in joints:\n            parent = joint.find(\'parent\')\n            child = joint.find(\'child\')\n\n            if parent is not None and child is not None:\n                parent_link = parent.get(\'link\')\n                child_link = child.get(\'link\')\n\n                if parent_link not in link_names:\n                    print(f"ERROR: Joint \'{joint.get(\'name\')}\' references non-existent parent link \'{parent_link}\'")\n                    return False\n\n                if child_link not in link_names:\n                    print(f"ERROR: Joint \'{joint.get(\'name\')}\' references non-existent child link \'{child_link}\'")\n                    return False\n\n        print("\u2713 URDF structure validation passed")\n        return True\n\n    except ET.ParseError as e:\n        print(f"ERROR: Invalid XML syntax - {e}")\n        return False\n    except FileNotFoundError:\n        print(f"ERROR: File not found - {urdf_file_path}")\n        return False\n    except Exception as e:\n        print(f"ERROR: Unexpected error - {e}")\n        return False\n\n\ndef main():\n    if len(sys.argv) != 2:\n        print("Usage: python3 validate_urdf.py <urdf_file_path>")\n        sys.exit(1)\n\n    urdf_file = sys.argv[1]\n    print(f"Validating URDF file: {urdf_file}")\n    print("-" * 40)\n\n    if validate_urdf(urdf_file):\n        print("-" * 40)\n        print("SUCCESS: URDF validation passed!")\n        return 0\n    else:\n        print("-" * 40)\n        print("FAILURE: URDF validation failed!")\n        return 1\n\n\nif __name__ == \'__main__\':\n    sys.exit(main())\n'})}),"\n",(0,o.jsx)(e.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,o.jsx)(e.h3,{id:"urdf-organization",children:"URDF Organization"}),"\n",(0,o.jsxs)(e.ol,{children:["\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Use Xacro"}),": Makes complex URDFs more manageable"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Modular design"}),": Break robot into logical components"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Parameterization"}),": Use properties for dimensions that might change"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Clear naming"}),": Use consistent, descriptive names"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Documentation"}),": Comment complex sections"]}),"\n"]}),"\n",(0,o.jsx)(e.h3,{id:"performance-considerations",children:"Performance Considerations"}),"\n",(0,o.jsxs)(e.ol,{children:["\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Simplified collision geometry"}),": Use simple shapes for collision detection"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Appropriate mesh resolution"}),": Balance detail with performance"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Realistic inertial properties"}),": Use actual physical values"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Efficient joint limits"}),": Set realistic constraints"]}),"\n"]}),"\n",(0,o.jsx)(e.p,{children:"These examples demonstrate how to properly structure URDF files for use with ROS 2 and simulators, ensuring your humanoid robot models work correctly in both visualization and simulation environments."})]})}function u(n={}){const{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,o.jsx)(e,{...n,children:(0,o.jsx)(d,{...n})}):d(n)}},8453(n,e,i){i.d(e,{R:()=>a,x:()=>s});var t=i(6540);const o={},r=t.createContext(o);function a(n){const e=t.useContext(r);return t.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function s(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(o):n.components||o:a(n.components),t.createElement(r.Provider,{value:e},n.children)}}}]);