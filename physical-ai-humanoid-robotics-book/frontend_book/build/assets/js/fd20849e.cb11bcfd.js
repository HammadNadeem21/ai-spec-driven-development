"use strict";(globalThis.webpackChunkfrontend_book=globalThis.webpackChunkfrontend_book||[]).push([[77],{2038(i,n,e){e.r(n),e.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"modules/digital-twin/chapter-1-physics-simulation","title":"Physics Simulation with Gazebo","description":"Introduction to Digital Twins in Robotics","source":"@site/docs/modules/digital-twin/chapter-1-physics-simulation.md","sourceDirName":"modules/digital-twin","slug":"/modules/digital-twin/chapter-1-physics-simulation","permalink":"/docs/modules/digital-twin/chapter-1-physics-simulation","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/modules/digital-twin/chapter-1-physics-simulation.md","tags":[],"version":"current","frontMatter":{"title":"Physics Simulation with Gazebo","sidebar_label":"Chapter 1 - Physics Simulation"},"sidebar":"tutorialSidebar","previous":{"title":"Chapter 3: Humanoid Modeling with URDF","permalink":"/docs/modules/ros2-robotics/chapter-3-urdf-modeling"},"next":{"title":"Chapter 2 - Unity Visualization","permalink":"/docs/modules/digital-twin/chapter-2-unity-visualization"}}');var o=e(4848),t=e(8453);const r={title:"Physics Simulation with Gazebo",sidebar_label:"Chapter 1 - Physics Simulation"},l="Physics Simulation with Gazebo",a={},c=[{value:"Introduction to Digital Twins in Robotics",id:"introduction-to-digital-twins-in-robotics",level:2},{value:"The Role of Digital Twins",id:"the-role-of-digital-twins",level:3},{value:"Why Gazebo for Physics Simulation",id:"why-gazebo-for-physics-simulation",level:3},{value:"Understanding Gazebo Physics",id:"understanding-gazebo-physics",level:2},{value:"Core Physics Concepts",id:"core-physics-concepts",level:3},{value:"Setting Up a Basic Gazebo Environment",id:"setting-up-a-basic-gazebo-environment",level:3},{value:"Configuring Gravity and Dynamics",id:"configuring-gravity-and-dynamics",level:3},{value:"Integrating Gazebo with ROS 2",id:"integrating-gazebo-with-ros-2",level:2},{value:"ROS 2 Gazebo Packages",id:"ros-2-gazebo-packages",level:3},{value:"Launching a Robot in Gazebo",id:"launching-a-robot-in-gazebo",level:3},{value:"Simulating Gravity, Collisions, and Dynamics",id:"simulating-gravity-collisions-and-dynamics",level:2},{value:"Gravity Simulation",id:"gravity-simulation",level:3},{value:"Collision Detection",id:"collision-detection",level:3},{value:"Dynamics and Joint Simulation",id:"dynamics-and-joint-simulation",level:3},{value:"Practical Exercise: Creating Your First Gazebo Simulation",id:"practical-exercise-creating-your-first-gazebo-simulation",level:2},{value:"Exercise Objective",id:"exercise-objective",level:3},{value:"Prerequisites",id:"prerequisites",level:3},{value:"Steps",id:"steps",level:3},{value:"Expected Results",id:"expected-results",level:3},{value:"Troubleshooting Common Physics Issues",id:"troubleshooting-common-physics-issues",level:2},{value:"Robot Falls Through Ground",id:"robot-falls-through-ground",level:3},{value:"Unstable Simulation",id:"unstable-simulation",level:3},{value:"Joint Behavior Issues",id:"joint-behavior-issues",level:3},{value:"Summary",id:"summary",level:2}];function d(i){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...i.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"physics-simulation-with-gazebo",children:"Physics Simulation with Gazebo"})}),"\n",(0,o.jsx)(n.h2,{id:"introduction-to-digital-twins-in-robotics",children:"Introduction to Digital Twins in Robotics"}),"\n",(0,o.jsx)(n.p,{children:"A digital twin is a high-fidelity virtual representation of a physical humanoid robot that simulates physics, environment, and sensor behavior. In robotics, digital twins serve as a safe and cost-effective environment to test algorithms, validate behaviors, and train AI models before deploying to real hardware."}),"\n",(0,o.jsx)(n.h3,{id:"the-role-of-digital-twins",children:"The Role of Digital Twins"}),"\n",(0,o.jsx)(n.p,{children:"Digital twins provide several key benefits in robotics development:"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Risk Reduction"}),": Test dangerous or complex maneuvers in simulation first"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Cost Efficiency"}),": Avoid wear and tear on expensive hardware"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Rapid Prototyping"}),": Iterate on algorithms quickly without physical constraints"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"AI Training"}),": Generate large datasets for machine learning without real-world data collection"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"System Validation"}),": Verify system behavior under various conditions"]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"why-gazebo-for-physics-simulation",children:"Why Gazebo for Physics Simulation"}),"\n",(0,o.jsx)(n.p,{children:"Gazebo is the industry standard for robotics physics simulation due to its:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Accurate physics engine with support for complex dynamics"}),"\n",(0,o.jsx)(n.li,{children:"Integration with ROS 2 for seamless communication"}),"\n",(0,o.jsx)(n.li,{children:"Extensive sensor simulation capabilities"}),"\n",(0,o.jsx)(n.li,{children:"Large community and ecosystem"}),"\n",(0,o.jsx)(n.li,{children:"Realistic rendering and visualization"}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"understanding-gazebo-physics",children:"Understanding Gazebo Physics"}),"\n",(0,o.jsx)(n.h3,{id:"core-physics-concepts",children:"Core Physics Concepts"}),"\n",(0,o.jsx)(n.p,{children:"Gazebo uses the ODE (Open Dynamics Engine) physics engine by default, with support for other engines like Bullet and DART. The physics simulation encompasses:"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Gravity"}),": Constant acceleration affecting all objects"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Collision Detection"}),": Identifying when objects intersect"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Dynamics"}),": How forces affect object motion"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Friction"}),": Surface interaction forces"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Contact Stiffness"}),": How objects respond to contact"]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"setting-up-a-basic-gazebo-environment",children:"Setting Up a Basic Gazebo Environment"}),"\n",(0,o.jsx)(n.p,{children:"To create a basic Gazebo simulation environment:"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Install Gazebo"}),": Ensure Gazebo Fortress or Garden is installed"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Create a World File"}),": Define the environment in SDF (Simulation Description Format)"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Configure Physics Parameters"}),": Set gravity, damping, and other physical properties"]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"Here's a basic world file structure:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-xml",children:'<?xml version="1.0" ?>\n<sdf version="1.7">\n  <world name="digital_twin_world">\n    \x3c!-- Include default ground plane --\x3e\n    <include>\n      <uri>model://ground_plane</uri>\n    </include>\n\n    \x3c!-- Include default lighting --\x3e\n    <include>\n      <uri>model://sun</uri>\n    </include>\n\n    \x3c!-- Physics parameters --\x3e\n    <physics type="ode">\n      <gravity>0 0 -9.8</gravity>\n      <max_step_size>0.001</max_step_size>\n      <real_time_factor>1.0</real_time_factor>\n      <real_time_update_rate>1000</real_time_update_rate>\n    </physics>\n\n    \x3c!-- Your robot will be spawned here --\x3e\n  </world>\n</sdf>\n'})}),"\n",(0,o.jsx)(n.h3,{id:"configuring-gravity-and-dynamics",children:"Configuring Gravity and Dynamics"}),"\n",(0,o.jsx)(n.p,{children:"The physics parameters in your world file control how objects behave:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Gravity"}),": Typically set to [0, 0, -9.8] m/s\xb2 for Earth-like gravity"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Max Step Size"}),": Smaller values provide more accurate but slower simulation"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Real Time Factor"}),": Controls simulation speed relative to real time"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Update Rate"}),": How frequently physics calculations occur"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"integrating-gazebo-with-ros-2",children:"Integrating Gazebo with ROS 2"}),"\n",(0,o.jsx)(n.h3,{id:"ros-2-gazebo-packages",children:"ROS 2 Gazebo Packages"}),"\n",(0,o.jsx)(n.p,{children:"ROS 2 provides several packages for Gazebo integration:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"gazebo_ros_pkgs"}),": Core ROS 2 plugins for Gazebo"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"gazebo_dev"}),": Development tools and messages"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"ros_gz"}),": Modern bridge between ROS 2 and Gazebo Garden"]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"launching-a-robot-in-gazebo",children:"Launching a Robot in Gazebo"}),"\n",(0,o.jsx)(n.p,{children:"To launch a humanoid robot model in Gazebo with ROS 2 integration:"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Ensure Robot Model is Available"}),": The URDF/XACRO model must be properly formatted"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Create Launch File"}),": Define the launch sequence"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Spawn Robot"}),": Use ROS 2 services to spawn the robot in simulation"]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"Example launch file:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-python",children:"from launch import LaunchDescription\nfrom launch.actions import DeclareLaunchArgument, IncludeLaunchDescription\nfrom launch.launch_description_sources import PythonLaunchDescriptionSource\nfrom launch.substitutions import PathJoinSubstitution, LaunchConfiguration\nfrom launch_ros.actions import Node\nfrom launch_ros.substitutions import FindPackageShare\n\ndef generate_launch_description():\n    # World file to load\n    world_file_arg = DeclareLaunchArgument(\n        'world',\n        default_value='digital_twin_world.sdf',\n        description='Choose one of the world files from `/your_robot_gazebo/worlds`'\n    )\n\n    # Launch Gazebo\n    gazebo = IncludeLaunchDescription(\n        PythonLaunchDescriptionSource([\n            FindPackageShare('gazebo_ros'),\n            '/launch/gazebo.launch.py'\n        ]),\n        launch_arguments={\n            'world': PathJoinSubstitution([\n                FindPackageShare('your_robot_gazebo'),\n                'worlds',\n                LaunchConfiguration('world')\n            ])\n        }.items()\n    )\n\n    # Robot state publisher\n    robot_state_publisher = Node(\n        package='robot_state_publisher',\n        executable='robot_state_publisher',\n        name='robot_state_publisher',\n        output='screen',\n        parameters=[robot_description],\n    )\n\n    # Spawn entity\n    spawn_entity = Node(\n        package='gazebo_ros',\n        executable='spawn_entity.py',\n        arguments=[\n            '-topic', 'robot_description',\n            '-entity', 'your_robot',\n            '-x', '0.0',\n            '-y', '0.0',\n            '-z', '1.0'\n        ],\n        output='screen'\n    )\n\n    return LaunchDescription([\n        world_file_arg,\n        gazebo,\n        robot_state_publisher,\n        spawn_entity\n    ])\n"})}),"\n",(0,o.jsx)(n.h2,{id:"simulating-gravity-collisions-and-dynamics",children:"Simulating Gravity, Collisions, and Dynamics"}),"\n",(0,o.jsx)(n.h3,{id:"gravity-simulation",children:"Gravity Simulation"}),"\n",(0,o.jsx)(n.p,{children:"Gravity in Gazebo is a global force that affects all objects. You can configure it in your world file:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-xml",children:'<physics type="ode">\n  <gravity>0 0 -9.8</gravity>\n  \x3c!-- Other physics parameters --\x3e\n</physics>\n'})}),"\n",(0,o.jsx)(n.p,{children:"The gravity vector [x, y, z] defines the direction and magnitude of gravitational acceleration. You can adjust this to simulate different environments (e.g., moon gravity with [0, 0, -1.6])."}),"\n",(0,o.jsx)(n.h3,{id:"collision-detection",children:"Collision Detection"}),"\n",(0,o.jsx)(n.p,{children:"Gazebo handles collision detection through collision geometries defined in your robot model:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-xml",children:'<link name="link_name">\n  <collision name="collision">\n    <geometry>\n      <box>\n        <size>0.1 0.1 0.1</size>\n      </box>\n    </geometry>\n  </collision>\n</link>\n'})}),"\n",(0,o.jsx)(n.p,{children:"Common collision geometries include:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Box: For rectangular objects"}),"\n",(0,o.jsx)(n.li,{children:"Cylinder: For wheels and cylindrical parts"}),"\n",(0,o.jsx)(n.li,{children:"Sphere: For spherical objects"}),"\n",(0,o.jsx)(n.li,{children:"Mesh: For complex shapes"}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"dynamics-and-joint-simulation",children:"Dynamics and Joint Simulation"}),"\n",(0,o.jsx)(n.p,{children:"Gazebo accurately simulates joint dynamics including:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Joint limits and safety controllers"}),"\n",(0,o.jsx)(n.li,{children:"Friction and damping parameters"}),"\n",(0,o.jsx)(n.li,{children:"Effort and velocity limits"}),"\n",(0,o.jsx)(n.li,{children:"Transmission systems"}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"Example joint configuration:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-xml",children:'<joint name="joint_name" type="revolute">\n  <parent>parent_link</parent>\n  <child>child_link</child>\n  <limit effort="100" velocity="3.0" lower="-1.57" upper="1.57"/>\n  <dynamics damping="0.1" friction="0.0"/>\n</joint>\n'})}),"\n",(0,o.jsx)(n.h2,{id:"practical-exercise-creating-your-first-gazebo-simulation",children:"Practical Exercise: Creating Your First Gazebo Simulation"}),"\n",(0,o.jsx)(n.h3,{id:"exercise-objective",children:"Exercise Objective"}),"\n",(0,o.jsx)(n.p,{children:"Create a simple humanoid robot simulation that responds correctly to gravity and basic collisions."}),"\n",(0,o.jsx)(n.h3,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"ROS 2 Humble Hawksbill or later"}),"\n",(0,o.jsx)(n.li,{children:"Gazebo Fortress or Garden"}),"\n",(0,o.jsx)(n.li,{children:"Basic understanding of URDF"}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"steps",children:"Steps"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Create a Simple World File"}),"\nCreate ",(0,o.jsx)(n.code,{children:"digital_twin_world.sdf"})," in your worlds directory with basic physics parameters."]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Launch the Simulation"}),"\nUse the launch file structure provided above to start Gazebo with your world."]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Verify Physics Behavior"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Check that objects fall due to gravity"}),"\n",(0,o.jsx)(n.li,{children:"Verify collision detection by placing objects near each other"}),"\n",(0,o.jsx)(n.li,{children:"Test joint dynamics with simple movements"}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Validate Integration"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Confirm ROS 2 topics are publishing correctly"}),"\n",(0,o.jsx)(n.li,{children:"Verify TF transforms are available"}),"\n",(0,o.jsx)(n.li,{children:"Check that robot state is being published"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"expected-results",children:"Expected Results"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Robot model appears in Gazebo environment"}),"\n",(0,o.jsx)(n.li,{children:"Robot responds to gravity (if not fixed in place)"}),"\n",(0,o.jsx)(n.li,{children:"Collision detection works properly"}),"\n",(0,o.jsx)(n.li,{children:"ROS 2 communication channels are active"}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"troubleshooting-common-physics-issues",children:"Troubleshooting Common Physics Issues"}),"\n",(0,o.jsx)(n.h3,{id:"robot-falls-through-ground",children:"Robot Falls Through Ground"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Check collision geometries in URDF"}),"\n",(0,o.jsx)(n.li,{children:"Verify physics parameters in world file"}),"\n",(0,o.jsx)(n.li,{children:"Ensure proper link connections"}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"unstable-simulation",children:"Unstable Simulation"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Reduce max_step_size in physics configuration"}),"\n",(0,o.jsx)(n.li,{children:"Adjust solver parameters"}),"\n",(0,o.jsx)(n.li,{children:"Check for intersecting collision geometries"}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"joint-behavior-issues",children:"Joint Behavior Issues"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Verify joint limits and dynamics parameters"}),"\n",(0,o.jsx)(n.li,{children:"Check transmission configurations"}),"\n",(0,o.jsx)(n.li,{children:"Ensure proper controller setup"}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,o.jsx)(n.p,{children:"Physics simulation with Gazebo forms the foundation of digital twin technology for robotics. By accurately modeling gravity, collisions, and dynamics, you create a reliable environment for testing and development. The integration with ROS 2 enables seamless communication between your simulation and control systems, making it an essential tool for humanoid robot development."}),"\n",(0,o.jsx)(n.p,{children:"In the next chapter, we'll explore visualization and interaction using Unity, building on this physics foundation."})]})}function h(i={}){const{wrapper:n}={...(0,t.R)(),...i.components};return n?(0,o.jsx)(n,{...i,children:(0,o.jsx)(d,{...i})}):d(i)}},8453(i,n,e){e.d(n,{R:()=>r,x:()=>l});var s=e(6540);const o={},t=s.createContext(o);function r(i){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof i?i(n):{...n,...i}},[n,i])}function l(i){let n;return n=i.disableParentContext?"function"==typeof i.components?i.components(o):i.components||o:r(i.components),s.createElement(t.Provider,{value:n},i.children)}}}]);